# MoveScorer Performance Analysis

This directory contains tools for analyzing the performance of different MoveScorer models across various chess situations characterized by Lucas analytics.

## Overview

The analysis framework evaluates five types of MoveScorers:
1. **Opening** - Specializes in opening positions
2. **Midgame** - Specializes in midgame positions
3. **Endgame** - Specializes in endgame positions
4. **Tactics** - Specializes in tactical positions
5. **Defensive_tactics** - Specializes in defensive tactical positions

Each model is evaluated based on the rank at which it predicts the actual move played in real games, with ranks capped at 10. The goal is to determine in which chess situations (characterized by Lucas analytics) each model performs best.

## Lucas Analytics

Lucas analytics provides five key metrics for chess positions:
1. **Complexity** - How complex the position is (0 to 100)
2. **Win probability** - Probability of the side to move winning (0 to 100)
3. **Efficient mobility** - How easy it is to play without making mistakes (0 to 50)
4. **Narrowness** - How open the position is (0 to 50)
5. **Piece activity** - Activity level of the pieces of the side to move (0 to 25)

These metrics, along with the game phase (opening, midgame, endgame), are used to characterize chess situations.

## Files

- `run_analysis.py` - Main script to run the analysis on PGN files
- `movescorer_analyzer.py` - Core analyzer class to evaluate model performance
- `visualizer.py` - Visualization tool to generate plots and charts
- `interactive_explorer.py` - Interactive tool to explore specific positions

## Usage

### Running the Analysis

To run the analysis on PGN files in the `train_PGNs` directory:

```bash
python model_research/run_analysis.py [options]
```

Options:
- `--max-games N` - Maximum number of games to analyze per PGN file (default: 10)
- `--max-positions N` - Maximum number of positions to analyze per game (default: 30)
- `--pgn-pattern STR` - Pattern to match PGN files (default: all in train_PGNs/)
- `--output-dir STR` - Directory to save results (default: model_research/results)

Example:
```bash
python model_research/run_analysis.py --max-games 20 --max-positions 50
```

### Interactive Exploration

To explore the analysis results interactively:

```bash
python model_research/interactive_explorer.py [results_file]
```

Where `results_file` is the path to the CSV results file generated by `run_analysis.py` (default: model_research/results/analysis_results.csv).

## Output

The analysis produces several outputs:

1. **Raw Results** - CSV file with detailed results for each analyzed position
2. **Plots** - Various plots showing model performance across different metrics
3. **Reports** - Text reports with insights and findings

### Plots

- Performance by game phase
- Performance by Lucas metrics
- Distribution of best-performing models
- Rank distributions
- Correlation between metrics and performance
- PCA of metrics and performance
- Radar charts of model performance
- Rank comparison scatter plots
- Heatmaps of model performance

### Reports

- Decision boundary report - Rules for when to use each model
- Visualization report - Summary of visualization findings

## Requirements

- Python 3.7+
- chess
- pandas
- numpy
- matplotlib
- seaborn
- scikit-learn
- tqdm

## Example Workflow

1. Run the analysis:
   ```bash
   python model_research/run_analysis.py
   ```

2. Explore the results interactively:
   ```bash
   python model_research/interactive_explorer.py
   ```

3. Review generated reports and plots in `model_research/reports` and `model_research/plots`

## Contributing

To extend this analysis framework:

1. Add new metrics or features to `movescorer_analyzer.py`
2. Add new visualizations to `visualizer.py`
3. Enhance the interactive explorer in `interactive_explorer.py` 